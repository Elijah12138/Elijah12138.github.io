{"title":"YOLOV5-Pytorch(VOC数据集格式)","uid":"ba1548c49789f1ddd9c64ce6b8cbf220","slug":"YOLOV5-Pytorch(VOC数据集格式)","date":"2022-07-03T12:46:54.000Z","updated":"2022-07-17T14:56:39.095Z","comments":true,"path":"api/articles/YOLOV5-Pytorch(VOC数据集格式).json","keywords":null,"cover":"https://pic.imgdb.cn/item/62c18f405be16ec74a1693ca.png","content":"<h2 id=\"YOLOV5-Pytorch-VOC数据集格式\"><a href=\"#YOLOV5-Pytorch-VOC数据集格式\" class=\"headerlink\" title=\"YOLOV5-Pytorch(VOC数据集格式)\"></a>YOLOV5-Pytorch(VOC数据集格式)</h2><h3 id=\"1-下载官方代码并进行测试\"><a href=\"#1-下载官方代码并进行测试\" class=\"headerlink\" title=\"1. 下载官方代码并进行测试\"></a>1. 下载官方代码并进行测试</h3><h4 id=\"1-1-克隆github项目到本地\"><a href=\"#1-1-克隆github项目到本地\" class=\"headerlink\" title=\"1.1 克隆github项目到本地\"></a>1.1 克隆github项目到本地</h4><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\"># 已更新到v6.1版本\ngit clone https:&#x2F;&#x2F;github.com&#x2F;ultralytics&#x2F;yolov5.git<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"1-2-安装所需库\"><a href=\"#1-2-安装所需库\" class=\"headerlink\" title=\"1.2 安装所需库\"></a>1.2 安装所需库</h4><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">pip install -i https:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple -r requirements.txt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>测试环境: </p>\n<p>python: 3.7.2</p>\n<p>torch: 1.8.1+cu101</p>\n<p>torchvision: 0.9.1+cu101</p>\n<p>tensorboard: 2.9.1</p></blockquote>\n<h4 id=\"1-3-下载预训练权重文件\"><a href=\"#1-3-下载预训练权重文件\" class=\"headerlink\" title=\"1.3 下载预训练权重文件\"></a>1.3 下载预训练权重文件</h4><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>创建一个文件夹weights，用于保存下载的权重文件：</p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>官网下载地址：</p>\n<p><a href=\"https://github.com/ultralytics/yolov5/releases\">https://github.com/ultralytics/yolov5/releases</a></p>\n<p>本地如果没有下载权重文件，在运行<code>detect.py</code>时程序也会自动下载权重文件。</p></blockquote>\n<p><img src=\"https://pic.imgdb.cn/item/62c3dd5a5be16ec74a754b02.png\"></p>\n<h4 id=\"1-4-测试检测图片\"><a href=\"#1-4-测试检测图片\" class=\"headerlink\" title=\"1.4 测试检测图片\"></a>1.4 测试检测图片</h4><p>进入yolov5文件夹下，在cmd下运行命令：</p>\n<pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\"># 以yolov5s.pt为例\npython detect.py --weights weights&#x2F;yolov5s.pt --img 640 --conf 0.25 --source bus.jpg --data data&#x2F;coco.yaml<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://pic.imgdb.cn/item/62c3dd5a5be16ec74a754ba3.jpg\"></p>\n<h4 id=\"1-5-测试检测视频\"><a href=\"#1-5-测试检测视频\" class=\"headerlink\" title=\"1.5 测试检测视频\"></a>1.5 测试检测视频</h4><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">python detect.py --source data&#x2F;test_video.mp4 --weights weights&#x2F;yolov5n.pt  --data data&#x2F;coco.yaml<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n\n\n<h3 id=\"2-制作自己的数据集\"><a href=\"#2-制作自己的数据集\" class=\"headerlink\" title=\"2. 制作自己的数据集\"></a>2. 制作自己的数据集</h3><h4 id=\"2-1-重命名图片\"><a href=\"#2-1-重命名图片\" class=\"headerlink\" title=\"2.1 重命名图片\"></a>2.1 重命名图片</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> hashlib <span class=\"token keyword\">import</span> new\n<span class=\"token keyword\">import</span> os\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">rename_files</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    filelist <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>\n    filelist<span class=\"token punctuation\">.</span>sort<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    total_num <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>filelist<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"total number: &#123;&#125;\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>total_num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    i <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">for</span> item <span class=\"token keyword\">in</span> filelist<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> item<span class=\"token punctuation\">.</span>endswith<span class=\"token punctuation\">(</span><span class=\"token string\">'.jpg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            original_name <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n                new_name <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>zfill<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\".jpg\"</span><span class=\"token punctuation\">)</span>\n                i <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n                os<span class=\"token punctuation\">.</span>rename<span class=\"token punctuation\">(</span>original_name<span class=\"token punctuation\">,</span> new_name<span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&#123;&#125; rename ----> &#123;&#125;\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>original_name<span class=\"token punctuation\">,</span> new_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"rename dir fail\"</span><span class=\"token punctuation\">)</span>\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">\"./data\"</span>\n\nrename_files<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://pic.imgdb.cn/item/62c3dd5b5be16ec74a754c00.png\"></p>\n<h4 id=\"2-2-缩小图片数据\"><a href=\"#2-2-缩小图片数据\" class=\"headerlink\" title=\"2.2 缩小图片数据\"></a>2.2 缩小图片数据</h4><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>防止出现图片数据过大，显存溢出的现象。</p></blockquote>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> Image\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">resize_images</span><span class=\"token punctuation\">(</span>dirPath<span class=\"token punctuation\">,</span> new_dirPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    fileName_list <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>dirPath<span class=\"token punctuation\">)</span>\n    filePath_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>dirPath<span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> fileName <span class=\"token keyword\">in</span> fileName_list<span class=\"token punctuation\">]</span>\n    imagePath_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>filePath <span class=\"token keyword\">for</span> filePath <span class=\"token keyword\">in</span> filePath_list <span class=\"token keyword\">if</span> <span class=\"token string\">'.jpg'</span> <span class=\"token keyword\">in</span> filePath<span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isdir<span class=\"token punctuation\">(</span>new_dirPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        os<span class=\"token punctuation\">.</span>mkdir<span class=\"token punctuation\">(</span>new_dirPath<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> imagePath <span class=\"token keyword\">in</span> imagePath_list<span class=\"token punctuation\">:</span>\n        image <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>imagePath<span class=\"token punctuation\">)</span>\n        width<span class=\"token punctuation\">,</span> height <span class=\"token operator\">=</span> image<span class=\"token punctuation\">.</span>size\n        imageName <span class=\"token operator\">=</span> imagePath<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">'\\\\'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n        save_path <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>new_dirPath<span class=\"token punctuation\">,</span> imageName<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> width <span class=\"token operator\">>=</span> <span class=\"token number\">600</span> <span class=\"token keyword\">and</span> height <span class=\"token operator\">>=</span> <span class=\"token number\">600</span><span class=\"token punctuation\">:</span>\n            minification <span class=\"token operator\">=</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">)</span> <span class=\"token operator\">//</span> <span class=\"token number\">300</span> <span class=\"token comment\">#此变量表示缩小倍数</span>\n            new_width <span class=\"token operator\">=</span> width <span class=\"token operator\">//</span> minification\n            new_height <span class=\"token operator\">=</span> height <span class=\"token operator\">//</span> minification\n            resized_image <span class=\"token operator\">=</span> image<span class=\"token punctuation\">.</span>resize<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>new_width<span class=\"token punctuation\">,</span> new_height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> Image<span class=\"token punctuation\">.</span>ANTIALIAS<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'图片&#123;&#125;原来的宽&#123;&#125;, 高&#123;&#125;, -------->  图片缩小后宽&#123;&#125;, 高&#123;&#125;'</span> <span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>imageName<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> new_width<span class=\"token punctuation\">,</span> new_height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            resized_image<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span>save_path<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            image<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span>save_path<span class=\"token punctuation\">)</span>\n\nresize_images<span class=\"token punctuation\">(</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'processed_data'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h4 id=\"2-3-安装labelImg\"><a href=\"#2-3-安装labelImg\" class=\"headerlink\" title=\"2.3 安装labelImg\"></a>2.3 安装labelImg</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\"># 安装labelImg\npip install labelImg\n\n# 启动labelImg\nlabelImg<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"2-4-标记数据\"><a href=\"#2-4-标记数据\" class=\"headerlink\" title=\"2.4 标记数据\"></a>2.4 标记数据</h4><ol>\n<li><p>点击<code>Open Dir</code>选择图片数据所在的文件夹，标记格式选择VOC格式；</p>\n<p><img src=\"https://pic.imgdb.cn/item/62c3dd5b5be16ec74a754ccf.png\"></p>\n</li>\n<li><p>按一下<code>w</code>键，即可标记目标数据，选定区域后输入所属的标签；</p>\n<p><img src=\"https://pic.imgdb.cn/item/62c3dd5c5be16ec74a754e1d.png\"></p>\n</li>\n<li><p>按住<code>ctrl+s</code>保存标记的信息；</p>\n<p><img src=\"https://pic.imgdb.cn/item/62c3dd5c5be16ec74a754ed8.png\"></p>\n</li>\n<li><p>切换图片，标记下一张。</p>\n<p><img src=\"https://pic.imgdb.cn/item/62c3dd5d5be16ec74a755035.png\"></p>\n</li>\n</ol>\n<h3 id=\"3-训练数据\"><a href=\"#3-训练数据\" class=\"headerlink\" title=\"3. 训练数据\"></a>3. 训练数据</h3><h4 id=\"3-1-修改文件夹结构\"><a href=\"#3-1-修改文件夹结构\" class=\"headerlink\" title=\"3.1 修改文件夹结构\"></a>3.1 修改文件夹结构</h4><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>在yolov5文件夹下创建VOCdevkit &#x2F; VOC2007文件夹，VOC2007下面建立两个文件夹：Annotations和JPEGImages。</p>\n<p>JPEGImages放所有的训练和测试图片；Annotations放所有的xml标记文件</p></blockquote>\n<h4 id=\"3-2-预处理训练数据\"><a href=\"#3-2-预处理训练数据\" class=\"headerlink\" title=\"3.2 预处理训练数据\"></a>3.2 预处理训练数据</h4><p>在yolov5文件夹里运行代码：</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> xml<span class=\"token punctuation\">.</span>etree<span class=\"token punctuation\">.</span>ElementTree <span class=\"token keyword\">as</span> ET\n<span class=\"token keyword\">import</span> pickle\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">from</span> os <span class=\"token keyword\">import</span> listdir<span class=\"token punctuation\">,</span> getcwd\n<span class=\"token keyword\">from</span> os<span class=\"token punctuation\">.</span>path <span class=\"token keyword\">import</span> join\n<span class=\"token keyword\">import</span> random\n<span class=\"token keyword\">from</span> shutil <span class=\"token keyword\">import</span> copyfile\n\n<span class=\"token comment\"># 根据自己的数据标签修改</span>\nclasses<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"chicken_head\"</span><span class=\"token punctuation\">]</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">clear_hidden_files</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    dir_list <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> dir_list<span class=\"token punctuation\">:</span>\n        abspath <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>abspath<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isfile<span class=\"token punctuation\">(</span>abspath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> i<span class=\"token punctuation\">.</span>startswith<span class=\"token punctuation\">(</span><span class=\"token string\">\"._\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                os<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span>abspath<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            clear_hidden_files<span class=\"token punctuation\">(</span>abspath<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">convert</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">,</span> box<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    dw <span class=\"token operator\">=</span> <span class=\"token number\">1.</span><span class=\"token operator\">/</span>size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    dh <span class=\"token operator\">=</span> <span class=\"token number\">1.</span><span class=\"token operator\">/</span>size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n    x <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>box<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> box<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">2.0</span>\n    y <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>box<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> box<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">2.0</span>\n    w <span class=\"token operator\">=</span> box<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> box<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    h <span class=\"token operator\">=</span> box<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> box<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n    x <span class=\"token operator\">=</span> x<span class=\"token operator\">*</span>dw\n    w <span class=\"token operator\">=</span> w<span class=\"token operator\">*</span>dw\n    y <span class=\"token operator\">=</span> y<span class=\"token operator\">*</span>dh\n    h <span class=\"token operator\">=</span> h<span class=\"token operator\">*</span>dh\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">,</span>h<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">convert_annotation</span><span class=\"token punctuation\">(</span>image_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    in_file <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'VOCdevkit/VOC2007/Annotations/%s.xml'</span> <span class=\"token operator\">%</span>image_id<span class=\"token punctuation\">)</span>\n    out_file <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'VOCdevkit/VOC2007/YOLOLabels/%s.txt'</span> <span class=\"token operator\">%</span>image_id<span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span>\n    tree<span class=\"token operator\">=</span>ET<span class=\"token punctuation\">.</span>parse<span class=\"token punctuation\">(</span>in_file<span class=\"token punctuation\">)</span>\n    root <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">.</span>getroot<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    size <span class=\"token operator\">=</span> root<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'size'</span><span class=\"token punctuation\">)</span>\n    w <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n    h <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">for</span> obj <span class=\"token keyword\">in</span> root<span class=\"token punctuation\">.</span><span class=\"token builtin\">iter</span><span class=\"token punctuation\">(</span><span class=\"token string\">'object'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        difficult <span class=\"token operator\">=</span> obj<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'difficult'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text\n        cls <span class=\"token operator\">=</span> obj<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text\n        <span class=\"token keyword\">if</span> cls <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> classes <span class=\"token keyword\">or</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>difficult<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">continue</span>\n        cls_id <span class=\"token operator\">=</span> classes<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">(</span>cls<span class=\"token punctuation\">)</span>\n        xmlbox <span class=\"token operator\">=</span> obj<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'bndbox'</span><span class=\"token punctuation\">)</span>\n        b <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>xmlbox<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'xmin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>xmlbox<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'xmax'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>xmlbox<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'ymin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>xmlbox<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'ymax'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        bb <span class=\"token operator\">=</span> convert<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span>h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span>\n        out_file<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>cls_id<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> a <span class=\"token keyword\">in</span> bb<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span>\n    in_file<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    out_file<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nwd <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>getcwd<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nwd <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>getcwd<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndata_base_dir <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>wd<span class=\"token punctuation\">,</span> <span class=\"token string\">\"VOCdevkit/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isdir<span class=\"token punctuation\">(</span>data_base_dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    os<span class=\"token punctuation\">.</span>mkdir<span class=\"token punctuation\">(</span>data_base_dir<span class=\"token punctuation\">)</span>\nwork_sapce_dir <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>data_base_dir<span class=\"token punctuation\">,</span> <span class=\"token string\">\"VOC2007/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isdir<span class=\"token punctuation\">(</span>work_sapce_dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    os<span class=\"token punctuation\">.</span>mkdir<span class=\"token punctuation\">(</span>work_sapce_dir<span class=\"token punctuation\">)</span>\nannotation_dir <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>work_sapce_dir<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Annotations/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isdir<span class=\"token punctuation\">(</span>annotation_dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        os<span class=\"token punctuation\">.</span>mkdir<span class=\"token punctuation\">(</span>annotation_dir<span class=\"token punctuation\">)</span>\nclear_hidden_files<span class=\"token punctuation\">(</span>annotation_dir<span class=\"token punctuation\">)</span>\nimage_dir <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>work_sapce_dir<span class=\"token punctuation\">,</span> <span class=\"token string\">\"JPEGImages/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isdir<span class=\"token punctuation\">(</span>image_dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        os<span class=\"token punctuation\">.</span>mkdir<span class=\"token punctuation\">(</span>image_dir<span class=\"token punctuation\">)</span>\nclear_hidden_files<span class=\"token punctuation\">(</span>image_dir<span class=\"token punctuation\">)</span>\nyolo_labels_dir <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>work_sapce_dir<span class=\"token punctuation\">,</span> <span class=\"token string\">\"YOLOLabels/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isdir<span class=\"token punctuation\">(</span>yolo_labels_dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        os<span class=\"token punctuation\">.</span>mkdir<span class=\"token punctuation\">(</span>yolo_labels_dir<span class=\"token punctuation\">)</span>\nclear_hidden_files<span class=\"token punctuation\">(</span>yolo_labels_dir<span class=\"token punctuation\">)</span>\nyolov5_images_dir <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>data_base_dir<span class=\"token punctuation\">,</span> <span class=\"token string\">\"images/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isdir<span class=\"token punctuation\">(</span>yolov5_images_dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        os<span class=\"token punctuation\">.</span>mkdir<span class=\"token punctuation\">(</span>yolov5_images_dir<span class=\"token punctuation\">)</span>\nclear_hidden_files<span class=\"token punctuation\">(</span>yolov5_images_dir<span class=\"token punctuation\">)</span>\nyolov5_labels_dir <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>data_base_dir<span class=\"token punctuation\">,</span> <span class=\"token string\">\"labels/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isdir<span class=\"token punctuation\">(</span>yolov5_labels_dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        os<span class=\"token punctuation\">.</span>mkdir<span class=\"token punctuation\">(</span>yolov5_labels_dir<span class=\"token punctuation\">)</span>\nclear_hidden_files<span class=\"token punctuation\">(</span>yolov5_labels_dir<span class=\"token punctuation\">)</span>\nyolov5_images_train_dir <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>yolov5_images_dir<span class=\"token punctuation\">,</span> <span class=\"token string\">\"train/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isdir<span class=\"token punctuation\">(</span>yolov5_images_train_dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        os<span class=\"token punctuation\">.</span>mkdir<span class=\"token punctuation\">(</span>yolov5_images_train_dir<span class=\"token punctuation\">)</span>\nclear_hidden_files<span class=\"token punctuation\">(</span>yolov5_images_train_dir<span class=\"token punctuation\">)</span>\nyolov5_images_test_dir <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>yolov5_images_dir<span class=\"token punctuation\">,</span> <span class=\"token string\">\"val/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isdir<span class=\"token punctuation\">(</span>yolov5_images_test_dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        os<span class=\"token punctuation\">.</span>mkdir<span class=\"token punctuation\">(</span>yolov5_images_test_dir<span class=\"token punctuation\">)</span>\nclear_hidden_files<span class=\"token punctuation\">(</span>yolov5_images_test_dir<span class=\"token punctuation\">)</span>\nyolov5_labels_train_dir <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>yolov5_labels_dir<span class=\"token punctuation\">,</span> <span class=\"token string\">\"train/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isdir<span class=\"token punctuation\">(</span>yolov5_labels_train_dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        os<span class=\"token punctuation\">.</span>mkdir<span class=\"token punctuation\">(</span>yolov5_labels_train_dir<span class=\"token punctuation\">)</span>\nclear_hidden_files<span class=\"token punctuation\">(</span>yolov5_labels_train_dir<span class=\"token punctuation\">)</span>\nyolov5_labels_test_dir <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>yolov5_labels_dir<span class=\"token punctuation\">,</span> <span class=\"token string\">\"val/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isdir<span class=\"token punctuation\">(</span>yolov5_labels_test_dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        os<span class=\"token punctuation\">.</span>mkdir<span class=\"token punctuation\">(</span>yolov5_labels_test_dir<span class=\"token punctuation\">)</span>\nclear_hidden_files<span class=\"token punctuation\">(</span>yolov5_labels_test_dir<span class=\"token punctuation\">)</span>\n\ntrain_file <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>wd<span class=\"token punctuation\">,</span> <span class=\"token string\">\"yolov5_train.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span>\ntest_file <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>wd<span class=\"token punctuation\">,</span> <span class=\"token string\">\"yolov5_val.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span>\ntrain_file<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntest_file<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntrain_file <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>wd<span class=\"token punctuation\">,</span> <span class=\"token string\">\"yolov5_train.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span>\ntest_file <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>wd<span class=\"token punctuation\">,</span> <span class=\"token string\">\"yolov5_val.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span>\nlist_imgs <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>image_dir<span class=\"token punctuation\">)</span> <span class=\"token comment\"># list image files</span>\nprobo <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Probobility: %d\"</span> <span class=\"token operator\">%</span> probo<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>list_imgs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    path <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>image_dir<span class=\"token punctuation\">,</span>list_imgs<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isfile<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        image_path <span class=\"token operator\">=</span> image_dir <span class=\"token operator\">+</span> list_imgs<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n        voc_path <span class=\"token operator\">=</span> list_imgs<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">(</span>nameWithoutExtention<span class=\"token punctuation\">,</span> extention<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>splitext<span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>basename<span class=\"token punctuation\">(</span>image_path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">(</span>voc_nameWithoutExtention<span class=\"token punctuation\">,</span> voc_extention<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>splitext<span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>basename<span class=\"token punctuation\">(</span>voc_path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        annotation_name <span class=\"token operator\">=</span> nameWithoutExtention <span class=\"token operator\">+</span> <span class=\"token string\">'.xml'</span>\n        annotation_path <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>annotation_dir<span class=\"token punctuation\">,</span> annotation_name<span class=\"token punctuation\">)</span>\n        label_name <span class=\"token operator\">=</span> nameWithoutExtention <span class=\"token operator\">+</span> <span class=\"token string\">'.txt'</span>\n        label_path <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>yolo_labels_dir<span class=\"token punctuation\">,</span> label_name<span class=\"token punctuation\">)</span>\n    probo <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Probobility: %d\"</span> <span class=\"token operator\">%</span> probo<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>probo <span class=\"token operator\">&lt;</span> <span class=\"token number\">80</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># train dataset</span>\n        <span class=\"token keyword\">if</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>exists<span class=\"token punctuation\">(</span>annotation_path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            train_file<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>image_path <span class=\"token operator\">+</span> <span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span>\n            convert_annotation<span class=\"token punctuation\">(</span>nameWithoutExtention<span class=\"token punctuation\">)</span> <span class=\"token comment\"># convert label</span>\n            copyfile<span class=\"token punctuation\">(</span>image_path<span class=\"token punctuation\">,</span> yolov5_images_train_dir <span class=\"token operator\">+</span> voc_path<span class=\"token punctuation\">)</span>\n            copyfile<span class=\"token punctuation\">(</span>label_path<span class=\"token punctuation\">,</span> yolov5_labels_train_dir <span class=\"token operator\">+</span> label_name<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># test dataset</span>\n        <span class=\"token keyword\">if</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>exists<span class=\"token punctuation\">(</span>annotation_path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            test_file<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>image_path <span class=\"token operator\">+</span> <span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span>\n            convert_annotation<span class=\"token punctuation\">(</span>nameWithoutExtention<span class=\"token punctuation\">)</span> <span class=\"token comment\"># convert label</span>\n            copyfile<span class=\"token punctuation\">(</span>image_path<span class=\"token punctuation\">,</span> yolov5_images_test_dir <span class=\"token operator\">+</span> voc_path<span class=\"token punctuation\">)</span>\n            copyfile<span class=\"token punctuation\">(</span>label_path<span class=\"token punctuation\">,</span> yolov5_labels_test_dir <span class=\"token operator\">+</span> label_name<span class=\"token punctuation\">)</span>\ntrain_file<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntest_file<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"3-3-修改配置文件\"><a href=\"#3-3-修改配置文件\" class=\"headerlink\" title=\"3.3 修改配置文件\"></a>3.3 修改配置文件</h4><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>新建文件<code>data/voc-chicken.yaml</code>， 内容如下：</p></blockquote>\n<pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">train: ..&#x2F;yolov5&#x2F;VOCdevkit&#x2F;images&#x2F;train&#x2F;\nval: ..&#x2F;yolov5&#x2F;VOCdevkit&#x2F;images&#x2F;val&#x2F;\n\n# number of classes\nnc: 1\n\n# class names\nnames: [&#39;chicken_head&#39;]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>复制models&#x2F;yolov5s.yaml重命名为models&#x2F;yolov5s-chicken.yaml 然后修改配置参数：</p></blockquote>\n<pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\"># Parameters\nnc: 1  # number of classes<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"3-4-训练数据\"><a href=\"#3-4-训练数据\" class=\"headerlink\" title=\"3.4 训练数据\"></a>3.4 训练数据</h4><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">python train.py --data data&#x2F;voc-chicken.yaml --cfg models&#x2F;yolov5s-chicken.yaml --weights weights&#x2F;yolov5s.pt --epochs 500 --device 0 --batch-size 16<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://pic.imgdb.cn/item/62c3dd5d5be16ec74a7550aa.png\"></p>\n<p><img src=\"https://pic.imgdb.cn/item/62c420a55be16ec74adcc5e6.png\"></p>\n<h3 id=\"4-训练数据可视化以及性能统计\"><a href=\"#4-训练数据可视化以及性能统计\" class=\"headerlink\" title=\"4. 训练数据可视化以及性能统计\"></a>4. 训练数据可视化以及性能统计</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\"># 安装Tensorboard\npip install tensorboard\n\n# 启动Tensorboard\ntensorboard --logdir&#x3D;.&#x2F;runs\n\n# 启动后，在浏览器输入http:&#x2F;&#x2F;localhost:6006&#x2F;即可<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://pic.imgdb.cn/item/62c3dd5e5be16ec74a755124.png\"></p>\n<p><img src=\"https://pic.imgdb.cn/item/62c3dd5e5be16ec74a7552a9.png\"></p>\n<h3 id=\"5-测试训练效果\"><a href=\"#5-测试训练效果\" class=\"headerlink\" title=\"5. 测试训练效果\"></a>5. 测试训练效果</h3><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">python detect.py --weights weights&#x2F;best.pt --img 640 --conf 0.25 --source pic1.png --data data&#x2F;voc-chicken.yaml<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://pic.imgdb.cn/item/62c3dd5f5be16ec74a755387.png\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 测试模型效果\npython val.py --weights weights&#x2F;best.pt --img 640 --conf 0.25 --data data&#x2F;voc-chicken.yaml --batch-size 8<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://pic.imgdb.cn/item/62c3dd5f5be16ec74a7553e3.png\"></p>\n<h3 id=\"6-使用ONNX格式并进行测试\"><a href=\"#6-使用ONNX格式并进行测试\" class=\"headerlink\" title=\"6. 使用ONNX格式并进行测试\"></a>6. 使用<code>ONNX</code>格式并进行测试</h3><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>查看<code>ONNX</code>模型的结构：</p>\n<p><a href=\"https://netron.app/\">https://netron.app/</a></p></blockquote>\n<h4 id=\"6-1-将pt模型转换为onnx模型\"><a href=\"#6-1-将pt模型转换为onnx模型\" class=\"headerlink\" title=\"6.1 将pt模型转换为onnx模型\"></a>6.1 将<code>pt</code>模型转换为<code>onnx</code>模型</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">python export<span class=\"token punctuation\">.</span>py <span class=\"token operator\">-</span><span class=\"token operator\">-</span>weights weights<span class=\"token operator\">/</span>best<span class=\"token punctuation\">.</span>pt <span class=\"token operator\">-</span><span class=\"token operator\">-</span>img <span class=\"token number\">640</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>batch <span class=\"token number\">1</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>opset <span class=\"token number\">12</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"6-2-通过OpenCV使用ONNX模型\"><a href=\"#6-2-通过OpenCV使用ONNX模型\" class=\"headerlink\" title=\"6.2 通过OpenCV使用ONNX模型\"></a>6.2 通过OpenCV使用ONNX模型</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">python detect.py --weights weights&#x2F;best.onnx --dnn --source pic1.png --img 640 --data data&#x2F;voc-chicken.yaml<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n\n\n","text":"YOLOV5-Pytorch(VOC数据集格式)1. 下载官方代码并进行测试1.1 克隆github项目到本地# 已更新到v6.1版本 git clone https:&#x2F;&#x2F;github.com&#x2F;ultralytics&#x2F;yolov5.git ...","link":"","photos":[],"count_time":{"symbolsCount":"9.7k","symbolsTime":"9 mins."},"categories":[{"name":"目标检测","slug":"目标检测","count":3,"path":"api/categories/目标检测.json"},{"name":"机器学习","slug":"目标检测/机器学习","count":3,"path":"api/categories/目标检测/机器学习.json"},{"name":"深度学习","slug":"目标检测/机器学习/深度学习","count":3,"path":"api/categories/目标检测/机器学习/深度学习.json"},{"name":"yolo","slug":"目标检测/机器学习/深度学习/yolo","count":3,"path":"api/categories/目标检测/机器学习/深度学习/yolo.json"}],"tags":[{"name":"目标检测","slug":"目标检测","count":3,"path":"api/tags/目标检测.json"},{"name":"机器学习","slug":"机器学习","count":4,"path":"api/tags/机器学习.json"},{"name":"深度学习","slug":"深度学习","count":4,"path":"api/tags/深度学习.json"},{"name":"yolo","slug":"yolo","count":3,"path":"api/tags/yolo.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#YOLOV5-Pytorch-VOC%E6%95%B0%E6%8D%AE%E9%9B%86%E6%A0%BC%E5%BC%8F\"><span class=\"toc-text\">YOLOV5-Pytorch(VOC数据集格式)</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E4%B8%8B%E8%BD%BD%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E5%B9%B6%E8%BF%9B%E8%A1%8C%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">1. 下载官方代码并进行测试</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-1-%E5%85%8B%E9%9A%86github%E9%A1%B9%E7%9B%AE%E5%88%B0%E6%9C%AC%E5%9C%B0\"><span class=\"toc-text\">1.1 克隆github项目到本地</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-2-%E5%AE%89%E8%A3%85%E6%89%80%E9%9C%80%E5%BA%93\"><span class=\"toc-text\">1.2 安装所需库</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-3-%E4%B8%8B%E8%BD%BD%E9%A2%84%E8%AE%AD%E7%BB%83%E6%9D%83%E9%87%8D%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">1.3 下载预训练权重文件</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-4-%E6%B5%8B%E8%AF%95%E6%A3%80%E6%B5%8B%E5%9B%BE%E7%89%87\"><span class=\"toc-text\">1.4 测试检测图片</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-5-%E6%B5%8B%E8%AF%95%E6%A3%80%E6%B5%8B%E8%A7%86%E9%A2%91\"><span class=\"toc-text\">1.5 测试检测视频</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-%E5%88%B6%E4%BD%9C%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86\"><span class=\"toc-text\">2. 制作自己的数据集</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-1-%E9%87%8D%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%87\"><span class=\"toc-text\">2.1 重命名图片</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-2-%E7%BC%A9%E5%B0%8F%E5%9B%BE%E7%89%87%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">2.2 缩小图片数据</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-3-%E5%AE%89%E8%A3%85labelImg\"><span class=\"toc-text\">2.3 安装labelImg</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-4-%E6%A0%87%E8%AE%B0%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">2.4 标记数据</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">3. 训练数据</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-1-%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E5%A4%B9%E7%BB%93%E6%9E%84\"><span class=\"toc-text\">3.1 修改文件夹结构</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-2-%E9%A2%84%E5%A4%84%E7%90%86%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">3.2 预处理训练数据</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-3-%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">3.3 修改配置文件</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-4-%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">3.4 训练数据</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#4-%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%BB%A5%E5%8F%8A%E6%80%A7%E8%83%BD%E7%BB%9F%E8%AE%A1\"><span class=\"toc-text\">4. 训练数据可视化以及性能统计</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#5-%E6%B5%8B%E8%AF%95%E8%AE%AD%E7%BB%83%E6%95%88%E6%9E%9C\"><span class=\"toc-text\">5. 测试训练效果</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#6-%E4%BD%BF%E7%94%A8ONNX%E6%A0%BC%E5%BC%8F%E5%B9%B6%E8%BF%9B%E8%A1%8C%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">6. 使用ONNX格式并进行测试</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#6-1-%E5%B0%86pt%E6%A8%A1%E5%9E%8B%E8%BD%AC%E6%8D%A2%E4%B8%BAonnx%E6%A8%A1%E5%9E%8B\"><span class=\"toc-text\">6.1 将pt模型转换为onnx模型</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#6-2-%E9%80%9A%E8%BF%87OpenCV%E4%BD%BF%E7%94%A8ONNX%E6%A8%A1%E5%9E%8B\"><span class=\"toc-text\">6.2 通过OpenCV使用ONNX模型</span></a></li></ol></li></ol></li></ol>","author":{"name":"Elijah","slug":"blog-author","avatar":"https://pic.imgdb.cn/api/avatar","link":"/","description":"在生命的旅途中，要诚挚地珍惜，要深深地疼爱。在生命的旅途中，要努力地追寻，也要保持静观。在生命的旅途中，要有所敬畏，也要有所无惧。","socials":{"github":"https://github.com/Elijah12138?tab=repositories","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_40330033?spm=1000.2115.3001.5343","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"YOLOV5-ONNX-Flask","uid":"2748178e20072a32602a87f0ad5f4d49","slug":"YOLOV5-ONNX-Flask","date":"2022-07-05T12:46:54.000Z","updated":"2022-07-05T11:50:32.764Z","comments":true,"path":"api/articles/YOLOV5-ONNX-Flask.json","keywords":null,"cover":"https://pic.imgdb.cn/item/62c18f405be16ec74a1693ca.png","text":"YOLOV5-ONNX-Flask项目部署 Pytorch导出ONNX模型可以参考： https://elijah12138.github.io/post/YOLOV5-Pytorch 1. 下载项目到本地 github地址: 2. templates文件夹保存网页信息index...","link":"","photos":[],"count_time":{"symbolsCount":"10k","symbolsTime":"9 mins."},"categories":[{"name":"目标检测","slug":"目标检测","count":3,"path":"api/categories/目标检测.json"},{"name":"机器学习","slug":"目标检测/机器学习","count":3,"path":"api/categories/目标检测/机器学习.json"},{"name":"深度学习","slug":"目标检测/机器学习/深度学习","count":3,"path":"api/categories/目标检测/机器学习/深度学习.json"},{"name":"yolo","slug":"目标检测/机器学习/深度学习/yolo","count":3,"path":"api/categories/目标检测/机器学习/深度学习/yolo.json"}],"tags":[{"name":"目标检测","slug":"目标检测","count":3,"path":"api/tags/目标检测.json"},{"name":"机器学习","slug":"机器学习","count":4,"path":"api/tags/机器学习.json"},{"name":"深度学习","slug":"深度学习","count":4,"path":"api/tags/深度学习.json"},{"name":"yolo","slug":"yolo","count":3,"path":"api/tags/yolo.json"},{"name":"ONNX","slug":"ONNX","count":1,"path":"api/tags/ONNX.json"},{"name":"Flask","slug":"Flask","count":1,"path":"api/tags/Flask.json"}],"author":{"name":"Elijah","slug":"blog-author","avatar":"https://pic.imgdb.cn/api/avatar","link":"/","description":"在生命的旅途中，要诚挚地珍惜，要深深地疼爱。在生命的旅途中，要努力地追寻，也要保持静观。在生命的旅途中，要有所敬畏，也要有所无惧。","socials":{"github":"https://github.com/Elijah12138?tab=repositories","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_40330033?spm=1000.2115.3001.5343","juejin":"","customs":{}}}},"next_post":{"title":"Matplotlib常用方法","uid":"85cf65706b3185fdb70607bc9be65855","slug":"Matplotlib常用方法","date":"2022-06-30T13:27:12.000Z","updated":"2022-07-02T14:13:16.545Z","comments":true,"path":"api/articles/Matplotlib常用方法.json","keywords":null,"cover":"https://pic.imgdb.cn/item/62bfe4685be16ec74a0bf897.png","text":"Matplotlib常用方法1. Pyplot1.1 根据xy数据绘制默认图像import matplotlib.pyplot as plt import numpy as np y = np.random.randint(10, 20, size=10) plt.plot(y)...","link":"","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[{"name":"机器学习","slug":"机器学习","count":1,"path":"api/categories/机器学习.json"},{"name":"深度学习","slug":"机器学习/深度学习","count":1,"path":"api/categories/机器学习/深度学习.json"},{"name":"Matplotlib","slug":"机器学习/深度学习/Matplotlib","count":1,"path":"api/categories/机器学习/深度学习/Matplotlib.json"}],"tags":[{"name":"机器学习","slug":"机器学习","count":4,"path":"api/tags/机器学习.json"},{"name":"深度学习","slug":"深度学习","count":4,"path":"api/tags/深度学习.json"},{"name":"Matplotlib","slug":"Matplotlib","count":1,"path":"api/tags/Matplotlib.json"}],"author":{"name":"Elijah","slug":"blog-author","avatar":"https://pic.imgdb.cn/api/avatar","link":"/","description":"在生命的旅途中，要诚挚地珍惜，要深深地疼爱。在生命的旅途中，要努力地追寻，也要保持静观。在生命的旅途中，要有所敬畏，也要有所无惧。","socials":{"github":"https://github.com/Elijah12138?tab=repositories","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_40330033?spm=1000.2115.3001.5343","juejin":"","customs":{}}}}}